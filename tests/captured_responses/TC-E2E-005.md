## Summary
The DAG review found reliability issues: use of `datetime.now()`, non-idempotent INSERT behavior, and missing retry/backoff defaults.

## Decision
Request changes in the DAG review: replace `datetime.now()` with Airflow templates, replace bare INSERT with idempotent load logic, and add retry/backoff defaults.

## Rationale
`datetime.now()` makes scheduling nondeterministic. Bare `INSERT` can duplicate data on retries. Reliable DAGs need explicit retry and exponential backoff settings with execution timeouts.

## Trade-offs
| Option | Pros | Cons | When to Use |
|--------|------|------|-------------|
| Strict reliability guardrails | Fewer incidents, safer reruns | Slightly more code/config | Production DAGs |
| Minimal DAG config | Faster initial coding | Higher operational risk | Prototypes only |

## Next Steps
1. Replace `datetime.now()` with `{{ ds }}` or `{{ data_interval_start }}`.
2. Replace INSERT with MERGE or DELETE+INSERT.
3. Set retries and backoff (`retries=3`, exponential retry_delay).
4. Re-run DAG review template and resolve all FAIL items.

## Template
DAG review status should include PASS/FAIL outcomes in `templates/airflow_dag_review.md`.
